# 课题 2：月度动态——季节性、价格与入住率预测

> 提示：本课题偏时间序列分析，适合作为“中等难度”选题。  
> 通用规范（EDA、Train/Val/Test、Git、报告撰写等）请参考课程总 README。

---

## 一、课题背景与核心问题

在某个城市中，房源的价格和入住率会随月份变化：  
- 是否存在明显的 **旺季 / 淡季**？  
- 价格与入住率的月度变化是否有规律？  
- 能否对未来几个月的 `occupancy` 或 `revenue` 提前做出预测，为定价与运营决策提供参考？

---

## 二、数据字段建议

### 1. Calendar Rates（按月汇总）

- 索引字段：`listing_id, date`（每行代表某个 listing 在某个月的汇总情况）
- 核心指标：
  - `vacant_days, reserved_days, occupancy`
  - `revenue, rate_avg, booked_rate_avg`
  - `booking_lead_time_avg, length_of_stay_avg, min_nights_avg`

### 2. Listings（筛选房源与增加静态特征）

- 示例字段：`city, listing_type, room_type, guests, bedrooms, superhost, professional_management` 等。

---

## 三、必做任务

### 1. 时间序列数据构建

选定：

- 一个城市（`city`），以及  
- 一个子市场（例如：`room_type = "Entire home/apt"` 且 `guests` 在 2–4 人区间）。

构建时间序列时，在以下两种方案中任选 **一种**：

1. **方式 A：市场级聚合时间序列**  
   - 将该子市场中所有房源按月份聚合，得到“市场级”序列，例如：  
     - 每个月的平均 `occupancy, rate_avg, revenue`；
2. **方式 B：多 listing 时间序列**  
   - 选择 3–5 个代表性房源；  
   - 为每个 listing 构建自己的月度时间序列。

> 要求：在报告中说明你选择 A 或 B 的理由（例如关注整体市场 vs 单个房东）。

### 2. 探索性分析（EDA）

至少完成：

1. 绘制 2–3 年（若数据范围允许）的 `occupancy` 与 `rate_avg` 时间序列图；
2. 分析：
   - 是否存在稳定的季节性（比如每年暑假和节假日入住率明显上升）；  
   - 是否存在长期趋势（例如整体价格逐年上升/下降）；  
   - 是否出现异常月份（如疫情、特殊事件、长假等）。

可以尝试：

- 分解时间序列为趋势 + 季节性 + 残差（如使用 statsmodels 的季节分解函数），辅助理解。

### 3. 预测任务设定与模型构建

1. 选择 **一个主预测目标**（不要两个都做，以免分散精力）：  
   - `occupancy` 或 `revenue`。
2. 按时间划分训练集与测试集：  
   - 例如前 N 个月作为训练集，后 M 个月作为测试集；  
   - 禁止打乱时间顺序随机划分。
3. 至少实现 **一个传统时间序列模型**，例如：
   - ARIMA / SARIMA；  
   - 或 Prophet。

要求：

- 给出模型阶数/参数的选择方式（可用 AIC/BIC 或网格搜索等简单策略）；  
- 报告在测试集上的 MAE / RMSE 等指标；  
- 绘制预测曲线与真实曲线的对比图（至少包含测试区间）。

### 4. 结果解读与运营建议

在报告中讨论：

- 模型的预测性能是否能满足“粗略运营决策”的需要；  
- 预测结果是否成功捕捉季节性（旺季/淡季）；  
- 基于分析和预测，给出 2–3 条运营建议，例如：  
  - 旺季是否可以适度提高价格或提高最少入住天数；  
  - 淡季是否需要通过降价或缩短提前预订时间来提高入住率。

---

## 四、选做任务（加分项）

> 下列内容为选做，完成质量好的小组可在评分时加分。

1. **多变量时间序列预测**  
   - 在预测 `occupancy` 或 `revenue` 时，加入更多解释变量：  
     - 如 `booking_lead_time_avg, length_of_stay_avg, rate_avg` 等；  
   - 采用多变量 SARIMA、向量自回归（VAR），或“滞后特征 + 机器学习模型”（如 XGBoost）。

2. **深度学习模型尝试**  
   - 使用简单的 LSTM / GRU 网络进行序列预测；  
   - 与传统模型在 MAE / RMSE 上进行对比，并讨论在样本量不大时的优缺点。  
   > 不要求复杂网络结构，重点在于理解和实现流程。

3. **场景模拟：淡季降价策略**  
   - 基于历史“价格–入住率”关系，构造一个简单模型；  
   - 设计一个“淡季整体降价 10%”的场景，估算对收入的影响：  
     - 有可能入住率上升、但平均价格下降，综合效果如何？  
   - 以图表形式展示不同策略下的结果对比，并给出结论。
